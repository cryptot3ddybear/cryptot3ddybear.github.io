<!doctype html><html lang=en><head><title>BSC-SCAM: PancakeSwap NoApproval :: Blockchain Security Stories</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A guide for crypto traders and a technical analysis of a popular Binance Smart Chain smart contract scam resulting in an inability to Approve swapping on PancakeSwap.
 Originaly posted as gist LINK, but migrated to a new blog.
 The scam is based on a modified _approve method which allows only the owner of the token to swap SCAMTOKEN-&amp;gt;BNB and prevents other swaps.
Example and analysis is based on  token: Ape  https://bscscan."><meta name=keywords content="bsc,scam,approval,security"><meta name=robots content="noodp"><link rel=canonical href=https://cryptot3ddybear.github.io/posts/scam-explained-bsc-noapproval/><link rel=stylesheet href=https://cryptot3ddybear.github.io/assets/style.css><link rel=stylesheet href=https://cryptot3ddybear.github.io/assets/green.css><link rel=apple-touch-icon href=https://cryptot3ddybear.github.io/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://cryptot3ddybear.github.io/img/favicon/green.png><meta name=twitter:card content="summary"><meta name=twitter:site content="https://twitter.com/cryptot3ddybear"><meta name=twitter:creator content="cryptot3ddybear"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="BSC-SCAM: PancakeSwap NoApproval"><meta property="og:description" content="A guide for crypto traders and a technical analysis of a popular Binance Smart Chain smart contract scam resulting in an inability to Approve swapping on PancakeSwap.
 Originaly posted as gist LINK, but migrated to a new blog.
 The scam is based on a modified _approve method which allows only the owner of the token to swap SCAMTOKEN-&amp;gt;BNB and prevents other swaps.
Example and analysis is based on  token: Ape  https://bscscan."><meta property="og:url" content="https://cryptot3ddybear.github.io/posts/scam-explained-bsc-noapproval/"><meta property="og:site_name" content="Blockchain Security Stories"><meta property="og:image" content="https://cryptot3ddybear.github.io/"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2021-04-08 22:17:00 +0000 UTC"></head><body class=green><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Blockchain Security Stories</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=https://github.com/cryptot3ddybear>@github</a></li><li><a href=https://twitter.com/cryptot3ddybear>@twitter</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=https://github.com/cryptot3ddybear>@github</a></li><li><a href=https://twitter.com/cryptot3ddybear>@twitter</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://cryptot3ddybear.github.io/posts/scam-explained-bsc-noapproval/>BSC-SCAM: PancakeSwap NoApproval</a></h1><div class=post-meta><span class=post-date>2021-04-08</span>
<span class=post-author>:: cryptot3ddybear</span></div><span class=post-tags>#<a href=https://cryptot3ddybear.github.io/tags/scam/>scam</a>&nbsp;
#<a href=https://cryptot3ddybear.github.io/tags/bsc/>bsc</a>&nbsp;
#<a href=https://cryptot3ddybear.github.io/tags/pancakeswap/>pancakeswap</a>&nbsp;
#<a href=https://cryptot3ddybear.github.io/tags/solidity/>solidity</a>&nbsp;
#<a href=https://cryptot3ddybear.github.io/tags/security/>security</a>&nbsp;
#<a href=https://cryptot3ddybear.github.io/tags/blockchainsec/>blockchainsec</a>&nbsp;</span><div class=post-content><div><p>A guide for crypto traders and a technical analysis of a popular
Binance Smart Chain smart contract scam resulting in an inability
to Approve swapping on PancakeSwap.</p><blockquote><p>Originaly posted as gist <a href=https://gist.github.com/cryptoteddybear/9f771ec284c3cbf70486cc2087b4deb7>LINK</a>, but migrated to a new blog.</p></blockquote><p>The scam is based on a modified <code>_approve</code> method which allows only the owner of the token to swap <code>SCAMTOKEN->BNB</code> and prevents other swaps.</p><h1 id=example-and-analysis-is-based-on>Example and analysis is based on<a href=#example-and-analysis-is-based-on class=hanchor arialabel=Anchor>&#8983;</a></h1><ul><li>token: Ape<ul><li><a href=https://bscscan.com/token/0x4ec0a6637c8b81593a2a893d10754bd3cb5254e7>https://bscscan.com/token/0x4ec0a6637c8b81593a2a893d10754bd3cb5254e7</a></li></ul></li><li>contract<ul><li><a href=https://bscscan.com/address/0x4ec0a6637c8b81593a2a893d10754bd3cb5254e7>https://bscscan.com/address/0x4ec0a6637c8b81593a2a893d10754bd3cb5254e7</a></li></ul></li><li>scammer&rsquo;s wallet:<ul><li><a href=https://bscscan.com/address/0x8dcf2b0c9a75b565e451a7f76067714cd96f03a1>https://bscscan.com/address/0x8dcf2b0c9a75b565e451a7f76067714cd96f03a1</a></li></ul></li></ul><h1 id=other-similar-scam-coins>Other similar scam coins<a href=#other-similar-scam-coins class=hanchor arialabel=Anchor>&#8983;</a></h1><ul><li>Eclipse - <a href=https://tokensniffer.com/token/0xe50b465ae2356cae271c464fa440e06dd8e0cb04>https://tokensniffer.com/token/0xe50b465ae2356cae271c464fa440e06dd8e0cb04</a></li><li>Shining Star - <a href=https://tokensniffer.com/token/0x45be63857c9df528542d3e72355e193a8dc0896f>https://tokensniffer.com/token/0x45be63857c9df528542d3e72355e193a8dc0896f</a></li><li>SafeGravity - <a href=https://tokensniffer.com/token/0x563a930333dd3934ecc4ab0006ddd8d05eca5873>https://tokensniffer.com/token/0x563a930333dd3934ecc4ab0006ddd8d05eca5873</a></li></ul><h1 id=tldr>TLDR;<a href=#tldr class=hanchor arialabel=Anchor>&#8983;</a></h1><ul><li>First transaction is a transfer of nearly all funds from <code>0x0000000000000000000000000000000000000000</code> to the owner of the contract</li><li>Second transaction is add liquidity of all transfered funds and BNB to Pancake LP</li><li>People are swapping <code>BNB->SCAMTOKEN</code>, but nobody can swap back, due to no way to <code>_approve</code></li><li>Scammer can from time to time to a swap back to make it look more legit as he is the only one who can swap <code>SCAMTOKEN->BNB</code></li><li>Scammer pulls out his LP token</li></ul><h1 id=for-traders>For traders<a href=#for-traders class=hanchor arialabel=Anchor>&#8983;</a></h1><ul><li>code in a contract with IF clause and fixed address in <code>_approve</code> method</li><li>big liquidity is added at the very beginning</li><li>no locked liquidity (like for most of the fresh tokens)</li><li>swaps back (<code>SCAMTOKEN->BNB</code>) are only from a fixed wallet or maybe multiple fixed wallets in future, who knows how scammers modify that scam</li><li>chart is nearly green all the time as people swap and fall into a trap, but to see such chart some people need to fell into the trap already ;(</li></ul><h1 id=analysis>Analysis<a href=#analysis class=hanchor arialabel=Anchor>&#8983;</a></h1><h2 id=step-1----create-token-and-the-contract>STEP 1 &ndash; Create token and the contract<a href=#step-1----create-token-and-the-contract class=hanchor arialabel=Anchor>&#8983;</a></h2><p>The scammer in step one creates a contract with malicious <code>_approve</code> method:</p><p><a href=https://bscscan.com/address/0x4ec0a6637c8b81593a2a893d10754bd3cb5254e7#code>https://bscscan.com/address/0x4ec0a6637c8b81593a2a893d10754bd3cb5254e7#code</a></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>  <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>_approve</span>(<span style=color:#a6e22e>address</span> <span style=color:#a6e22e>owner</span>, <span style=color:#a6e22e>address</span> <span style=color:#a6e22e>spender</span>, <span style=color:#a6e22e>uint256</span> <span style=color:#a6e22e>amount</span>) <span style=color:#a6e22e>internal</span> {
    <span style=color:#a6e22e>require</span>(<span style=color:#a6e22e>owner</span> <span style=color:#f92672>!=</span> <span style=color:#a6e22e>address</span>(<span style=color:#ae81ff>0</span>), <span style=color:#e6db74>&#34;BEP20: approve from the zero address&#34;</span>);
    <span style=color:#a6e22e>require</span>(<span style=color:#a6e22e>spender</span> <span style=color:#f92672>!=</span> <span style=color:#a6e22e>address</span>(<span style=color:#ae81ff>0</span>), <span style=color:#e6db74>&#34;BEP20: approve to the zero address&#34;</span>);
    
    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>owner</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>address</span>(<span style=color:#ae81ff>0x8Dcf2B0C9A75b565e451a7F76067714cd96F03a1</span>)) {
        <span style=color:#a6e22e>_allowances</span>[<span style=color:#a6e22e>owner</span>][<span style=color:#a6e22e>spender</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>amount</span>;
        <span style=color:#a6e22e>emit</span> <span style=color:#a6e22e>Approval</span>(<span style=color:#a6e22e>owner</span>, <span style=color:#a6e22e>spender</span>, <span style=color:#a6e22e>amount</span>);
    } <span style=color:#66d9ef>else</span> {
        <span style=color:#a6e22e>_allowances</span>[<span style=color:#a6e22e>owner</span>][<span style=color:#a6e22e>spender</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
        <span style=color:#a6e22e>emit</span> <span style=color:#a6e22e>Approval</span>(<span style=color:#a6e22e>owner</span>, <span style=color:#a6e22e>spender</span>, <span style=color:#ae81ff>0</span>);
    }
  }
</code></pre></div><p>The if clause emits approval only when the owner of the contract is doing approving.</p><p>The following is the main part:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>owner</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>address</span>(<span style=color:#ae81ff>0x8Dcf2B0C9A75b565e451a7F76067714cd96F03a1</span>)) {
        <span style=color:#a6e22e>_allowances</span>[<span style=color:#a6e22e>owner</span>][<span style=color:#a6e22e>spender</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>amount</span>;
        <span style=color:#a6e22e>emit</span> <span style=color:#a6e22e>Approval</span>(<span style=color:#a6e22e>owner</span>, <span style=color:#a6e22e>spender</span>, <span style=color:#a6e22e>amount</span>);
    } 
</code></pre></div><h2 id=step-2----add-liquidity>STEP 2 &ndash; Add liquidity<a href=#step-2----add-liquidity class=hanchor arialabel=Anchor>&#8983;</a></h2><p>The scamer next adds a lot of liquidity.</p><p><a href=https://bscscan.com/tx/0xf24a7fe95dcffe4c7c6c782668f96ec2be52b34d996bc452a8847a1dd7352387>https://bscscan.com/tx/0xf24a7fe95dcffe4c7c6c782668f96ec2be52b34d996bc452a8847a1dd7352387</a></p><p>According to Transaction Action.</p><pre><code>Add 95,000 APE And 11 BNB Liquidity To PancakeSwap
</code></pre><h2 id=step-3----waiting-for-victims-and-swaps>STEP 3 &ndash; Waiting for victims and swaps<a href=#step-3----waiting-for-victims-and-swaps class=hanchor arialabel=Anchor>&#8983;</a></h2><p>People are swapping, but nobody is actually swapping it back as it is not possible due to the malicious <code>_approve</code> function.</p><p>On a chart it can be seen that the chart is only green and constantly increasing, however as you can see in APE example, the scammer did swap back at some point, to pretend it is possible to swap back and for a moment the chart had some red candles.</p><p><a href=https://bscscan.com/tx/0x10ebd9e978d60ccecb08edbd8574fed206842e3a625c022346f50cd4513d0422>https://bscscan.com/tx/0x10ebd9e978d60ccecb08edbd8574fed206842e3a625c022346f50cd4513d0422</a></p><p>Sample swap back transaction from scammer&rsquo;s wallet (owner of the contract)</p><pre><code>From 0x8dcf2b0c9a75b565e451a7f76067714cd96f03a1To PancakeSwap: APE 21 For 100 Ape (APE)
From PancakeSwap: APE 21To PancakeSwap: Router For 0.012071609240905323 ($5.05) Wrapped BNB (WBNB)
</code></pre><h2 id=step-4----cash-out>STEP 4 &ndash; Cash-out<a href=#step-4----cash-out class=hanchor arialabel=Anchor>&#8983;</a></h2><p>When scammer wants to cash out, he/she simply takes out the LP token and BNB is increased, while the scam token is decreased, due to AMM and liquidity pools mechanics. People after all were only able to deposit BNB and buy SCAMToken.</p><p><a href=https://bscscan.com/tx/0x548d263b4c3197e5be7c3d6615c87d558984e8404f815701c8e38dcb6452c731>https://bscscan.com/tx/0x548d263b4c3197e5be7c3d6615c87d558984e8404f815701c8e38dcb6452c731</a></p><h2 id=results>Results<a href=#results class=hanchor arialabel=Anchor>&#8983;</a></h2><p>In this example with APE token it was not so smooth as the token has not got a traction and the scammer has not earned a lot.</p><pre><code>Remove 92,317.1 APE And 11.3202162031125056 BNB Liquidity FromPancakeSwap
</code></pre><p>compared to what was put into the liquidity pool</p><pre><code>Add 95,000 APE And 11 BNB Liquidity ToPancakeSwap
</code></pre><p>So only ~0.32 BNB earned, this time. In other cases it was way more around 11 BNB.</p><h1 id=final-thoughts>Final thoughts<a href=#final-thoughts class=hanchor arialabel=Anchor>&#8983;</a></h1><ul><li>msg <a href=https://twitter.com/cryptot3ddybear>me@Twitter</a> if you found a scam and want to know how it works
or increase your chances to not fell for it again</li></ul><h1 id=buy-a-coffee>Buy a coffee<a href=#buy-a-coffee class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Found it useful? Learnt something? Saved your moeny? Buy a coffee:</p><pre><code>MetaMask Wallet address (Etherum, BSC)
0xD9Da5Fd5B049Da96e8C51738Ea93501f2e414EE6
</code></pre><img src=/img/cryptoteddybear-wallet-Etherum_BSC.png alt="Coffee & Scam Analysis Fund" class=center style=border-radius:8px></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://cryptot3ddybear.github.io/posts/scam-explained-bsc-stealthy-lp-block/><span class=button__icon>←</span>
<span class=button__text>BSC-SCAM: Stealthy Liquidity Pool Block on PancakeSwap</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2021 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://cryptot3ddybear.github.io/assets/main.js></script><script src=https://cryptot3ddybear.github.io/assets/prism.js></script></div></body></html>